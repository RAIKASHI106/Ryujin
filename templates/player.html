<script>
(function() {
    const player = document.getElementById('player');
    const epList = document.getElementById('episodesList');
    const epPanel = document.getElementById('episodesPanel');

    const folder = document.body.dataset.folder;
    let videos = JSON.parse(document.body.dataset.videos || '[]');

    let currentIdx = 0;

    function loadVideo(index) {
        if (!videos.length) return;
        currentIdx = index;
        player.src = videos[index].url;  // external link from log.json
        player.load();
        renderEpisodes();
    }

    function renderEpisodes() {
        epList.innerHTML = '';
        videos.forEach((v, i) => {
            const div = document.createElement('div');
            div.className = `item ${i === currentIdx ? 'active' : ''}`;
            div.innerText = v.name || `Episode ${i+1}`;
            div.onclick = () => { loadVideo(i); player.play(); epPanel.classList.remove('open'); };
            epList.appendChild(div);
        });
    }

    loadVideo(0); // auto load first episode
})();
</script>
